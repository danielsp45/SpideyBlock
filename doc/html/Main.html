<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Main</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Daniel da Silva Pereira &lt;a100545@alunos.uminho.pt&gt;;<br />: Rodrigo Viana Ramos Casal Novo &lt;a100534@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Main</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Tipos de Dados acrescentados</a><ul><li><a href="#g:2">Tipos</a></li><li><a href="#g:3">Datas</a></li></ul></li><li><a href="#g:4">Fun&#231;&#227;o Main</a></li><li><a href="#g:5">Fun&#231;&#245;es Auxiliares</a><ul><li><a href="#g:6">Estado Inicial</a></li><li><a href="#g:7">Imagem do Estado Centrada</a></li><li><a href="#g:8">Altera&#231;&#227;o Com Eventos</a><ul><li><a href="#g:9">Imagens Dos Jogadores</a></li><li><a href="#g:10">Desenho Do Mapa</a></li></ul></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 5 do projeto de LI1 em 2021/22 juntamente com novos tipos para auxilio nesta tarefa.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:World">World</a> = (<a href="Main.html#t:Estado" title="Main">Estado</a>, <a href="Main.html#t:Imagens" title="Main">Imagens</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:OpcaoAtual">OpcaoAtual</a> = (Int, Int)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Estado">Estado</a><ul class="subs"><li>= <a href="#v:Menu">Menu</a> <a href="Main.html#t:OpcaoAtual" title="Main">OpcaoAtual</a> String Int [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]</li><li>| <a href="#v:Pause">Pause</a> Int <a href="Main.html#t:Estado" title="Main">Estado</a></li><li>| <a href="#v:Playable">Playable</a> ([<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]) Picture Picture <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li>| <a href="#v:Multiplayer">Multiplayer</a> ([<a href="Mapas.html#t:Jogo-39-" title="Mapas">Jogo'</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]) Picture Picture Picture <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Imagens">Imagens</a> = <a href="#v:Imagens">Imagens</a> {<ul class="subs"><li><a href="#v:pecas">pecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, Picture)]</li><li><a href="#v:jogador">jogador</a> :: [(<a href="LI12122.html#t:Direcao" title="LI12122">Direcao</a>, Picture)]</li><li><a href="#v:jogador-39-">jogador'</a> :: [(String, Picture)]</li><li><a href="#v:backgraunds">backgraunds</a> :: [(String, Picture)]</li><li><a href="#v:botoes">botoes</a> :: [(Int, Picture)]</li></ul>}</li><li class="src short"><a href="#v:main">main</a> :: IO ()</li><li class="src short"><a href="#v:inicialState">inicialState</a> :: <a href="Main.html#t:Estado" title="Main">Estado</a></li><li class="src short"><a href="#v:printState">printState</a> :: <a href="Main.html#t:World" title="Main">World</a> -&gt; IO Picture</li><li class="src short"><a href="#v:reageTecla">reageTecla</a> :: Event -&gt; <a href="Main.html#t:World" title="Main">World</a> -&gt; IO <a href="Main.html#t:World" title="Main">World</a></li><li class="src short"><a href="#v:pictureJogador">pictureJogador</a> :: <a href="Main.html#t:Imagens" title="Main">Imagens</a> -&gt; <a href="LI12122.html#t:Jogador" title="LI12122">Jogador</a> -&gt; Picture</li><li class="src short"><a href="#v:pictureJogador-39-">pictureJogador'</a> :: <a href="Main.html#t:Imagens" title="Main">Imagens</a> -&gt; <a href="LI12122.html#t:Jogador" title="LI12122">Jogador</a> -&gt; Picture</li><li class="src short"><a href="#v:mapaToPicture">mapaToPicture</a> :: <a href="Main.html#t:Imagens" title="Main">Imagens</a> -&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [Picture]</li><li class="src short"><a href="#v:pecaToPicture">pecaToPicture</a> :: <a href="Main.html#t:Imagens" title="Main">Imagens</a> -&gt; (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; Picture</li><li class="src short"><a href="#v:novoMapa">novoMapa</a> :: (([<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]), <a href="Main.html#t:Imagens" title="Main">Imagens</a>) -&gt; <a href="Main.html#t:World" title="Main">World</a></li><li class="src short"><a href="#v:novoMapa-39-">novoMapa'</a> :: (([<a href="Mapas.html#t:Jogo-39-" title="Mapas">Jogo'</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]), <a href="Main.html#t:Imagens" title="Main">Imagens</a>) -&gt; <a href="Main.html#t:World" title="Main">World</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Tipos de Dados acrescentados</h1></a><a href="#g:2" id="g:2"><h2>Tipos</h2></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:World" class="def">World</a> = (<a href="Main.html#t:Estado" title="Main">Estado</a>, <a href="Main.html#t:Imagens" title="Main">Imagens</a>) <a href="#t:World" class="selflink">#</a></p><div class="doc"><p>Tuplo com o <code><a href="Main.html#t:Estado" title="Main">Estado</a></code> atual e as <code><a href="Main.html#t:Imagens" title="Main">Imagens</a></code> que precisaremos ao longo do programa.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:OpcaoAtual" class="def">OpcaoAtual</a> = (Int, Int) <a href="#t:OpcaoAtual" class="selflink">#</a></p><div class="doc"><p>Par com o primeiro ou segundo menu e op&#231;&#227;o selecionada que diferencia cada modo.</p></div></div><a href="#g:3" id="g:3"><h2>Datas</h2></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Estado" class="def">Estado</a> <a href="#t:Estado" class="selflink">#</a></p><div class="doc"><p>Estado atual ou possiveis</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Menu" class="def">Menu</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a href="Main.html#t:OpcaoAtual" title="Main">OpcaoAtual</a></dfn><div class="doc"><p>Op&#231;&#227;o no menu selecionada</p></div></li><li><dfn class="src">String</dfn><div class="doc"><p>Modo de jogo selecionado</p></div></li><li><dfn class="src">Int</dfn><div class="doc"><p>N&#237;vel selecionado</p></div></li><li><dfn class="src">[<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]</dfn><div class="doc"><p>Jogo gravado</p></div></li></ul></div></td></tr><tr><td class="src"><a id="v:Pause" class="def">Pause</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">Int</dfn><div class="doc"><p>Op&#231;&#227;o 1(cima) ou op&#231;&#227;o 2(baixo)</p></div></li><li><dfn class="src"><a href="Main.html#t:Estado" title="Main">Estado</a></dfn><div class="doc"><p>Estado em que parou o Jogo</p></div></li></ul></div></td></tr><tr><td class="src"><a id="v:Playable" class="def">Playable</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">([<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>])</dfn><div class="doc"><p>Par de Jogos, sendo o primeiro o atual(singleplayer) e o segundo a &#250;ltima grava&#231;&#227;o</p></div></li><li><dfn class="src">Picture</dfn><div class="doc"><p>Imagem do <code>mapa</code> atual</p></div></li><li><dfn class="src">Picture</dfn><div class="doc"><p>Imagem do <code><a href="LI12122.html#t:Jogador" title="LI12122">Jogador</a></code></p></div></li><li><dfn class="src"><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></dfn><div class="doc"><p>Coordenadas da Porta </p></div></li></ul></div></td></tr><tr><td class="src"><a id="v:Multiplayer" class="def">Multiplayer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">([<a href="Mapas.html#t:Jogo-39-" title="Mapas">Jogo'</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>])</dfn><div class="doc"><p>Par de Jogos, sendo o primeiro o atual(multiplayer) e o segundo a &#250;ltima grava&#231;&#227;o</p></div></li><li><dfn class="src">Picture</dfn><div class="doc"><p>Imagem do <code>mapa</code> atual</p></div></li><li><dfn class="src">Picture</dfn><div class="doc"><p>Imagem do primeiro <code><a href="LI12122.html#t:Jogador" title="LI12122">Jogador</a></code></p></div></li><li><dfn class="src">Picture</dfn><div class="doc"><p>Imagem do segundo <code><a href="LI12122.html#t:Jogador" title="LI12122">Jogador</a></code></p></div></li><li><dfn class="src"><a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></dfn><div class="doc"><p>Coordenadas da Porta </p></div></li><li><dfn class="src">[<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</dfn><div class="doc"><p>Lista com todas as coordenadas das caixas no momento atual</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Imagens" class="def">Imagens</a> <a href="#t:Imagens" class="selflink">#</a></p><div class="doc"><p>lista de imagens </p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Imagens" class="def">Imagens</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:pecas" class="def">pecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, Picture)]</dfn><div class="doc"><p>par <code>pe&#231;a</code> e imagem correspondente</p></div></li><li><dfn class="src"><a id="v:jogador" class="def">jogador</a> :: [(<a href="LI12122.html#t:Direcao" title="LI12122">Direcao</a>, Picture)]</dfn><div class="doc"><p>par <code>dire&#231;&#227;o</code> e imagem correspondente do jogador 1</p></div></li><li><dfn class="src"><a id="v:jogador-39-" class="def">jogador'</a> :: [(String, Picture)]</dfn><div class="doc"><p>par <code>dire&#231;&#227;o</code> ou <code>pe&#231;a</code> auxiliares ao multiplayer (segundo jogador e esmagar com caixa)</p></div></li><li><dfn class="src"><a id="v:backgraunds" class="def">backgraunds</a> :: [(String, Picture)]</dfn><div class="doc"><p>par local e respetiva imagem para backgrounds</p></div></li><li><dfn class="src"><a id="v:botoes" class="def">botoes</a> :: [(Int, Picture)]</dfn><div class="doc"><p>par nivel/extras e respetiva imagem do bot&#227;o para o menu</p></div></li></ul></div></td></tr></table></div></div><a href="#g:4" id="g:4"><h1>Fun&#231;&#227;o Main</h1></a><div class="top"><p class="src"><a id="v:main" class="def">main</a> :: IO () <a href="#v:main" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o main do Gloss 
Os p(n) s&#227;o imagens em formato .bmp importadas da pasta bmps utiliza as fun&#231;&#245;es </p><pre>main :: IO ()
main = do
    let estado = (inicialState,Imagens [(Bloco,p3),(Caixa,p4),(Porta,p5)] [(Oeste,p1),(Este,p2)] [(<a href="Oeste.html">Oeste</a>,p7),(<a href="Este.html">Este</a>,p6),(&quot;esmagarJ1&quot;,p8),(&quot;esmagarJ2&quot;,p9),(&quot;bracosAoArE&quot;,p26),(&quot;bracosAoArO&quot;,p27)] [(&quot;jogo1&quot;,p10),(&quot;jogo2&quot;,p11),(<a href="Menu.html">Menu</a>,p12),(<a href="Pause.html">Pause</a>,p28),(<a href="ControlSingle.html">ControlSingle</a>,p30),(<a href="ControlMult.html">ControlMult</a>,p29)] [(-1,p13),(-2,p14),(-3,p15),(-4,p16),(-5,p17),(-6,p18),(-8,p31),(-7,p32),(1,p19),(2,p20),(3,p21),(4,p22),(5,p23),(6,p24),(7,p25)])
    playIO
        FullScreen
        (light $ light blue)
        30
        estado
        <code><a href="Main.html#v:printState" title="Main">printState</a></code>
        <code><a href="Main.html#v:reageTecla" title="Main">reageTecla</a></code>
        time

</pre></div></div><a href="#g:5" id="g:5"><h1>Fun&#231;&#245;es Auxiliares</h1></a><a href="#g:6" id="g:6"><h2>Estado Inicial</h2></a><div class="top"><p class="src"><a id="v:inicialState" class="def">inicialState</a> <a href="#v:inicialState" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Main.html#t:Estado" title="Main">Estado</a></td><td class="doc"><p>Come&#231;a no menu inicial com a primeira op&#231;&#227;o selecionada</p></td></tr></table></div><div class="doc"><p>Estado Inicial</p></div></div><a href="#g:7" id="g:7"><h2>Imagem do Estado Centrada</h2></a><div class="top"><p class="src"><a id="v:printState" class="def">printState</a> <a href="#v:printState" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Main.html#t:World" title="Main">World</a></td><td class="doc"><p>Recebe o <code><a href="Main.html#t:Estado" title="Main">Estado</a></code> atual e as <code><a href="Main.html#t:Imagens" title="Main">Imagens</a></code></p></td></tr><tr><td class="src">-&gt; IO Picture</td><td class="doc"><p>Mostra na tela a jun&#231;&#227;o de todas as imagens
desenhar modo playable</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o printState verifica o estado e, dependendo do mesmo desenha no ecr&#227; o que acontece, isto &#233;:</p><ul><li>No caso de este ser um <code><a href="Main.html#v:Menu" title="Main">Menu</a></code> -&gt; Devolve o background adequado, o bot&#227;o selecionado aumentado, bem como o resto dos bot&#245;es em tamanho normal;  </li><li>No caso de este ser um <code><a href="Main.html#v:Playable" title="Main">Playable</a></code> -&gt; Devolve o background adequado e a jun&#231;&#227;o da imagem do mapa com o jogador (escolhidos no <code><a href="Main.html#v:reageTecla" title="Main">reageTecla</a></code>);  </li><li>No caso de este ser um <code><a href="Main.html#v:Multiplayer" title="Main">Multiplayer</a></code> -&gt; Devolve o background adequado e a jun&#231;&#227;o da imagem do mapa com a imagem personalizada dos jogadores (escolhidos no <code><a href="Main.html#v:reageTecla" title="Main">reageTecla</a></code>);</li><li>Por &#250;ltimo pode ser um menu <code><a href="Main.html#v:Pause" title="Main">Pause</a></code> -&gt; Devolve o background adequado, apresenta&#231;&#227;o das imagens dos controls, a apresenta&#231;&#227;o dos bot&#245;es (do mesmo modo que o menu).</li></ul></div></div><a href="#g:8" id="g:8"><h2>Altera&#231;&#227;o Com Eventos</h2></a><div class="top"><p class="src"><a id="v:reageTecla" class="def">reageTecla</a> <a href="#v:reageTecla" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Event</td><td class="doc"><p>Recebe uma tecla do teclado ou rato</p></td></tr><tr><td class="src">-&gt; <a href="Main.html#t:World" title="Main">World</a></td><td class="doc"><p>Recebe tamb&#233;m tamb&#233;m o est&#225;do antes da tecla ter sido primida</p></td></tr><tr><td class="src">-&gt; IO <a href="Main.html#t:World" title="Main">World</a></td><td class="doc"><p>Caso a tecla esteja definida para esse estado altera-o, caso contr&#225;rio devolve o mesmo estado
MainMenu</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o reageTecla, como o ome sugere, reage a uma Tecla e altera o estado de uma forma determinada:</p><ul><li><p>Nos menus as setas servem para navegar, alteram um dos valores dependendo de para onde se mexe e o Enter executa o que dado menu indica, isto &#233;:</p><ul><li>pode avan&#231;ar/voltar nos menus,</li><li>voltar aonde tinha gravado a ultima vez,</li><li>come&#231;ar um novo jogo onde se segue todos os niveis 1 a 1 (tanto no singleplayer como no multiplayer ),</li><li>fazer 1 nivel escolhido</li></ul></li><li>No SinglePlayer as setas e o a<em>s</em>w/d s&#227;o equivalentes a movimentos e existem teclas com funcionalidades a parte como o T para gravar, o Esc para parar e o R para reiniciar</li><li>No multiplayer est&#227;o dadas a cada um dos conjuntos um jogador e tamb&#233;m usofruem das teclas R e Esc</li></ul><p>O singleplayer foi relativamente simples como a unica coisa que alterava a imagem de fundo era o <code><a href="LI12122.html#v:InterageCaixa" title="LI12122">InterageCaixa</a></code> foi posto de parte porem os outros foram todos juntos numa fun&#231;&#227;o.</p><p>O &#250;nico problema era fazer o jogador entrar na porta pas isso foi conseguido com uma restri&#231;&#227;o e com altera&#231;&#245;es na tarefa 4.</p><pre>
--Jogo SinglePlayer
reageTecla (EventKey a Down _ _) (Playable (j:nextLevels,save) fundo _ c<code>(col,l), img) |b == InterageCaixa &amp;&amp; j /= nJ = return (Playable  (nJ:nextLevels,save) (Pictures (mapaToPicture img mapa (0,0))) imgJogador c, img)
                                             |b /= Nenhum &amp;&amp; (coord ==(col,l-1) || coord ==(col,l)) = return (<code><a href="Main.html#v:novoMapa" title="Main">novoMapa</a></code> ((j:nextLevels,save), img))
                                             |b <em>= Nenhum &amp;&amp; j </em>= nJ = return (Playable (nJ:nextLevels,save) fundo imgJogador c, img)
                    where (b,_) = traduzEvento a
                          nJ</code> (Jogo mapa jogador<code>(Jogador coord _ _)) = <code><a href="Tarefa4_2021li1g040.html#v:moveJogador" title="Tarefa4_2021li1g040">moveJogador</a></code> j b
                          imgJogador = pictureJogador img jogador

reageTecla (EventKey key Down _ _) (stt</code> Playable {}, img) | key == Char <code>p</code> || key == SpecialKey KeyEsc = return  (Pause 1 stt, img)
reageTecla (EventKey (Char <code>r</code>) Down _ _) (Playable (_:restartlevel@(Jogo mapa jogador):restoDosNiveis,save)  _  _ c, img) = return (Playable (restartlevel:restartlevel:restoDosNiveis,save) (Pictures (mapaToPicture img mapa (0,0))) (pictureJogador img jogador) c, img)
reageTecla (EventKey (Char <code>t</code>) Down _ _) (Playable (faseAtual,_) fundo jogador c, img) = do writeFile &quot;Load.text&quot; (show faseAtual)
                                                                                             return (Playable (faseAtual,faseAtual) fundo jogador c, img)
</pre><p>O multiplayer foi mais complicado de se fazer pois, ao contrario do singleplayer, n&#227;o se puderia usar a fun&#231;&#227;o <code><a href="Tarefa4_2021li1g040.html#v:moveJogador" title="Tarefa4_2021li1g040">moveJogador</a></code> diretamente dado que tinha dois jogadores,
para o fazermos tivemos que auxiliarmente chamar apenas o que queriamos (nj1 e nj2) e, com elas, devolver um novo jogo, mas com isso surgiu um outro problema, tinhamos dois jogadores e intera&#231;&#245;es entre eles teriam de existir.</p><p>Um exemplo disso &#233; quando o jogador &#233; esmagado pela caixa que o outro largou, tivemos ent&#227;o de fazer restri&#231;&#245;es para expecificamente o <code><a href="LI12122.html#v:InterageCaixa" title="LI12122">InterageCaixa</a></code>.</p><p>Depois queriamos que os jogadores entrassem na porta mas tal n&#227;o era possivel fizemos altera&#231;&#245;es na tarefa 4 e ent fizemos 3 restri&#231;&#245;es uma para cada jogador e uma para quando ambos entravam.</p><p>Por &#250;ltimo queriamos que o jogo continua-se depois de um jogador entrar na porta, e esse jogador n&#227;o se puderia mexer. Fizemos entr&#227;o mais duas restri&#231;&#245;es(uma para cada jogador).</p><pre>
--Jogo MultiPlayer
reageTecla (EventKey a Down _ _) start<code>(Multiplayer (j</code>(Jogo' m j1'<code>(Jogador coord1'</code>(colj1,linj1) _ _) j2'<code>(Jogador coord2'</code>(colj2,linj2) _ _)):nextLevels,save) fundo j1 j2 c<code>(col,l) boxs, img)
                  |n == 1 &amp;&amp; (elem coord1' boxs || coord1' == c) || n == 2 &amp;&amp; (elem coord2' boxs ||coord2' == c) = return start--- quando est&#225; com uma caixa por cima(nao se pode mexer) 

                  |n == 1 &amp;&amp; coord2' == c &amp;&amp; (coord1 == (col,l-1) || coord1 == c) = return $ <code><a href="Main.html#v:novoMapa-39-" title="Main">novoMapa'</a></code> ((j:nextLevels,save), img)--- entram na porta
                  |n == 2 &amp;&amp; coord1' == c &amp;&amp; (coord2 == (col,l-1) || coord2 == c) = return $ <code><a href="Main.html#v:novoMapa-39-" title="Main">novoMapa'</a></code> ((j:nextLevels,save), img)--- entram na porta

                  |b == (InterageCaixa,1) &amp;&amp; elem coord2' (caixas map1) = return (Multiplayer (nJ1:nextLevels,save) (Pictures (mapaToPicture img map1 (0,0))) imgJogador1 j2Esmagar c (caixas map1), img)  ---pega/larga caixa mas o outro jogador est&#225; a frente (esmaga-o) ou interage uma outra caixa enquanto est&#225; esmagado
                  |b == (InterageCaixa,1) &amp;&amp; coord2' == c = return (Multiplayer (nJ1:nextLevels,save) (Pictures (mapaToPicture img map1 (0,0))) imgJogador1 j2 c (caixas map1), img)                       ---pega/larga caixa pega numa caixa mas o outro jogador j&#225; acabou 
                  |b == (InterageCaixa,1) = return (Multiplayer (nJ1:nextLevels,save) (Pictures (mapaToPicture img map1 (0,0))) imgJogador1 (<code><a href="Main.html#v:pictureJogador-39-" title="Main">pictureJogador'</a></code> img j2') c (caixas map1), img)              ---pega/larga caixa normal 

                  |b == (InterageCaixa,2) &amp;&amp; elem coord1' (caixas map2) = return (Multiplayer (nJ2:nextLevels,save) (Pictures (mapaToPicture img map2 (0,0))) j1Esmagar imgJogador2 c (caixas map2), img)  ---pega/larga caixa mas o outro jogador est&#225; a frente (esmaga-o) ou interage uma outra caixa enquanto est&#225; esmagado
                  |b == (InterageCaixa,2) &amp;&amp; coord1' == c = return (Multiplayer (nJ2:nextLevels,save) (Pictures (mapaToPicture img map2 (0,0))) j1 imgJogador2 c (caixas map2), img)                       ---pega/larga caixa pega numa caixa mas o outro jogador j&#225; acabou 
                  |b == (InterageCaixa,2) = return (Multiplayer (nJ2:nextLevels,save) (Pictures (mapaToPicture img map2 (0,0))) (<code><a href="Main.html#v:pictureJogador" title="Main">pictureJogador</a></code> img j1') imgJogador2 c (caixas map2), img)               ---pega/larga caixa normal

                  |n == 1 &amp;&amp; (coord1 == (col,l-1) || coord1 == c) = return (Multiplayer (Jogo' map1 (Jogador c Este False) j2' :nextLevels,save) fundo fimJogador j2 c boxs, img) -- um dos jogadores ja acabou
                  |n == 2 &amp;&amp; (coord2 == (col,l-1) || coord2 == c) = return (Multiplayer (Jogo' map2 j1' (Jogador c Este False) :nextLevels,save) fundo j1 fimJogador c boxs, img) -- um dos jogadores ja acabou

                  |n == 1 = return (Multiplayer (nJ1:nextLevels,save) fundo imgJogador1 j2 c boxs, img) --move jogador1 como se fosse singleplayer
                  |n == 2 = return (Multiplayer (nJ2:nextLevels,save) fundo j1 imgJogador2 c boxs, img) --move jogador2 como se fosse singleplayer
                  where b</code>(mov,n) = traduzEvento a
                        nJ1<code> (Jogo' map1 jog1'</code>(Jogador coord1 _ _) _) = Jogo' nMapa nJogador j2'
                          where posMovimento<code>(Jogo nMapa nJogador) = <code><a href="Tarefa4_2021li1g040.html#v:moveJogador" title="Tarefa4_2021li1g040">moveJogador</a></code> (Jogo m j1') mov
                        nJ2</code> (Jogo' map2 _ jog2'<code>(Jogador coord2 _ _)) = Jogo' nMapa j1' nJogador
                          where posMovimento</code>(Jogo nMapa nJogador) = <code><a href="Tarefa4_2021li1g040.html#v:moveJogador" title="Tarefa4_2021li1g040">moveJogador</a></code> (Jogo m j2') mov
                        imgJogador1 = <code><a href="Main.html#v:pictureJogador" title="Main">pictureJogador</a></code>img jog1'
                        imgJogador2 = <code><a href="Main.html#v:pictureJogador-39-" title="Main">pictureJogador'</a></code> img jog2'
                        j2Esmagar = translate (fromIntegral(50*colj2)) (fromIntegral (-50*linj2-1)) $ scale 0.089 0.09 $ fromJust $ lookup &quot;esmagarJ2&quot; $ jogador' img
                        j1Esmagar = translate (fromIntegral(50*colj1)) (fromIntegral (-50*linj1-1)) $ scale 0.089 0.09 $ fromJust $ lookup &quot;esmagarJ1&quot; $ jogador' img
                        fimJogador = Translate (fromIntegral col*50+5) (fromIntegral (-l)*50) (scale 0.09 0.095 $ fromJust $ lookup Porta $ pecas img)

</pre></div></div><a href="#g:9" id="g:9"><h3>Imagens Dos Jogadores</h3></a><div class="top"><p class="src"><a id="v:pictureJogador" class="def">pictureJogador</a> <a href="#v:pictureJogador" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Main.html#t:Imagens" title="Main">Imagens</a></td><td class="doc"><p>Recebe as <code><a href="Main.html#t:Imagens" title="Main">Imagens</a></code> que vai utilizar</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Jogador" title="LI12122">Jogador</a></td><td class="doc"><p>Recebe tamb&#233;m o jogador que vai alterar</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>Devolve a imagem escalada e na posi&#231;&#227;o correspondente</p></td></tr></table></div><div class="doc"><p>Imagem do jogador</p></div></div><div class="top"><p class="src"><a id="v:pictureJogador-39-" class="def">pictureJogador'</a> <a href="#v:pictureJogador-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Main.html#t:Imagens" title="Main">Imagens</a></td><td class="doc"><p>Recebe as <code><a href="Main.html#t:Imagens" title="Main">Imagens</a></code> que vai utilizar</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Jogador" title="LI12122">Jogador</a></td><td class="doc"><p>Recebe tamb&#233;m o jogador que vai alterar</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>Devolve a imagem escalada e na posi&#231;&#227;o correspondente</p></td></tr></table></div><div class="doc"><p>O picture jogador &#233; utilizado quando acontece alguma altera&#231;&#227;o por parte de algum dos jogadores,
esta altera&#231;&#227;o pode ser quer na dire&#231;&#227;o, quer no booleano (carrega ou n&#227;o caixa) ou, obviamente, nas coordenadas.</p><p>Caso n&#227;o haja nenhuma destas situa&#231;&#245;es o movimento &#233; considerado in&#250;til e &#233; ignorado antes mesmo de esta fun&#231;&#227;o ser chamada.</p><p>O <code><a href="Main.html#v:pictureJogador" title="Main">pictureJogador</a></code> refere-se ao jogador do singleplayer e ao jogador1 do multiplayer e o <code><a href="Main.html#v:pictureJogador-39-" title="Main">pictureJogador'</a></code> refere-se ao jogador2 do multiplayer </p><pre>pictureJogador img (Jogador (c,l) dir withBox) |dir == Oeste &amp;&amp; withBox = pictures[Translate (fromIntegral (50*c)) (fromIntegral (50-50*l)) (scale 0.089 0.09 $ fromJust $ lookup Caixa $ pecas img),translate (fromIntegral (50*c)) (fromIntegral (-50*l)) $ scale 0.2 0.2 $ fromJust $ lookup &quot;bracosAoArO&quot; $ jogador' img]
                                               |withBox = pictures[Translate (fromIntegral (50*c)) (fromIntegral (50-50*l)) (scale 0.089 0.09 $ fromJust $ lookup Caixa $ pecas img), translate (fromIntegral (50*c)) (fromIntegral (-50*l)) $ scale 0.2 0.2 $fromJust $ lookup &quot;bracosAoArE&quot; $ jogador' img]
                                               |otherwise =  translate (fromIntegral (50*c)) (fromIntegral (-50*l)+1) $ scale 0.2 0.2 $fromJust $ lookup dir $ jogador img

pictureJogador' img (Jogador (c,l) dir withBox)|dir == Oeste &amp;&amp; withBox = pictures[Translate (fromIntegral (50*c)) (fromIntegral (50-50*l)) (scale 0.089 0.09 $ fromJust $ lookup Caixa $ pecas img),translate (fromIntegral (50*c)) (fromIntegral (-50*l-1)) $ scale 0.2 0.2 $ fromJust $ lookup <a href="Oeste.html">Oeste</a> $ jogador' img]
                                               |dir == Oeste =  translate (fromIntegral (50*c)) (fromIntegral (-50*l-1)) $ scale 0.2 0.2 $ fromJust $ lookup &quot;<a href="Oeste.html">Oeste</a>&quot; $ jogador' img
                                               |dir == Este &amp;&amp; withBox = pictures[Translate (fromIntegral (50*c)) (fromIntegral (50-50*l)) (scale 0.089 0.09 $ fromJust $ lookup Caixa $ pecas img), translate (fromIntegral (50*c)) (fromIntegral (-50*l-1)) $ scale 0.2 0.2 $fromJust $ lookup <a href="Este.html">Este</a> $ jogador' img]
                                               |otherwise =  translate (fromIntegral (50*c)) (fromIntegral (-50*l-1)) $ scale 0.2 0.2 $fromJust $ lookup &quot;<a href="Este.html">Este</a>&quot; $ jogador' img

</pre></div></div><a href="#g:10" id="g:10"><h3>Desenho Do Mapa</h3></a><div class="top"><p class="src"><a id="v:mapaToPicture" class="def">mapaToPicture</a> <a href="#v:mapaToPicture" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Main.html#t:Imagens" title="Main">Imagens</a></td><td class="doc"><p>Recebe as <code><a href="Main.html#t:Imagens" title="Main">Imagens</a></code> que vai utilizar</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Mapa" title="LI12122">Mapa</a></td><td class="doc"><p>Recebe o mapa que vai transformar</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Recebe as coordenadas da origem (0,0)</p></td></tr><tr><td class="src">-&gt; [Picture]</td><td class="doc"><p>Devolve o mapa em imagens com canto superior esquerdo na origem</p></td></tr></table></div><div class="doc"><p>Esta fun&#231;&#227;o percorre o mapa e a cada pe&#231;a transforma numa picture e desloca-a para o sitio onde se enquadra atrav&#233;s da fun&#231;&#227;o <code><a href="Main.html#v:pecaToPicture" title="Main">pecaToPicture</a></code></p></div></div><div class="top"><p class="src"><a id="v:pecaToPicture" class="def">pecaToPicture</a> <a href="#v:pecaToPicture" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Main.html#t:Imagens" title="Main">Imagens</a></td><td class="doc"><p>Recebe as <code><a href="Main.html#t:Imagens" title="Main">Imagens</a></code> que vai utilizar</p></td></tr><tr><td class="src">-&gt; (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)</td><td class="doc"><p>Recebe uma pe&#231;a e o local onde a colocar</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>Devolve a imagem da pe&#231;a na posi&#231;&#227;o desejada</p></td></tr></table></div><div class="doc"><p>Sem a importa&#231;&#227;o de imagens teria de ser usado formas geom&#233;tricas j&#225; predefinidas no Gloss em baixo est&#225; um exemplo de como o fizemos</p><pre>data Figura
    = Quadrado Int Color (Int,Int) --bloco e caixa
    | Rectangulo Int Int Color (Int,Int) -- porta

figurasToPicture :: [Figuras] -&gt; Picture
figurasToPicture l = Pictures $ map (figuraToPicuture) l 
figuraToPicture :: Figura -&gt; Picture
figuraToPicture (Quadrado l c (coluna,linha)) = Translate (fromIntegral coluna) (fromIntegral linha) $ Color c $ rectangleSolid (fromIntegral l)  (fromIntegral l)
figuraToPicture (Rectangulo b l c (coluna,linha)) = Translate (fromIntegral coluna) (fromIntegral linha) $ Color c $ rectangleSolid (fromIntegral b)  (fromIntegral l)

mapaToPicture :: (Mapa,Coordenadas) -&gt; [Figura]
mapaToPicture ([],_)= []
mapaToPicture ([]:resto,(_,l)) = mapaToPicture (resto,(0,l-50))
mapaToPicture ((x:resto):resto',(c,l)) | x == Bloco = Quadrado 50 black (c,l) : tail
                                       | x == Porta = Rectangulo 30 50 blue (c,l) : tail
                                       | x == Vazio = tail
                                       | x == Caixa = Quadrado 50 red (c,l) : tail
                                       | otherwise = error &quot;input n&#227;o &#233; um mapa&quot;
                    where tail = mapaToPicture (resto:resto',(c+50,l))
</pre></div></div><div class="top"><p class="src"><a id="v:novoMapa" class="def">novoMapa</a> :: (([<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]), <a href="Main.html#t:Imagens" title="Main">Imagens</a>) -&gt; <a href="Main.html#t:World" title="Main">World</a> <a href="#v:novoMapa" class="selflink">#</a></p><div class="doc"><p>muda para o pr&#243;ximo mapa da lista e quando acaba volta ao menu inicial</p></div></div><div class="top"><p class="src"><a id="v:novoMapa-39-" class="def">novoMapa'</a> :: (([<a href="Mapas.html#t:Jogo-39-" title="Mapas">Jogo'</a>], [<a href="LI12122.html#t:Jogo" title="LI12122">Jogo</a>]), <a href="Main.html#t:Imagens" title="Main">Imagens</a>) -&gt; <a href="Main.html#t:World" title="Main">World</a> <a href="#v:novoMapa-39-" class="selflink">#</a></p><div class="doc"><p>muda para o pr&#243;ximo mapa quando da lista e quando acaba volta ao menu inicial </p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>