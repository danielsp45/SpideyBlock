<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa1_2021li1g040</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Daniel da Silva Pereira &lt;a100545@alunos.uminho.pt&gt;;<br />: Rodrigo Viana Ramos Casal Novo &lt;a100534@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa1_2021li1g040</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 1 do projeto de LI1 em 2021/22.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:validaPotencialMapa">validaPotencialMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:percursoChao">percursoChao</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:listadoChao">listadoChao</a> :: Int -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:validaPosicao">validaPosicao</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validaPorta">validaPorta</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validaPorta-39-">validaPorta'</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validaCaixa">validaCaixa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validaEspacosVazios">validaEspacosVazios</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validaChao">validaChao</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:listaBlocos">listaBlocos</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:verifCont">verifCont</a> :: Int -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; Bool</li><li class="src short"><a href="#v:findFrstChao">findFrstChao</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:findLastChao">findLastChao</a> :: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></li><li class="src short"><a href="#v:eomaisbaixo">eomaisbaixo</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Bool</li><li class="src short"><a href="#v:habloco">habloco</a> :: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] -&gt; Bool</li><li class="src short"><a href="#v:tamanhoMapa">tamanhoMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; (Int, Int)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:validaPotencialMapa" class="def">validaPotencialMapa</a> <a href="#v:validaPotencialMapa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe um mapa </p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Diz se o pudemos usar</p></td></tr></table></div><div class="doc"><h1>Valida&#231;&#227;o do Mapa</h1><p>Para a validar&#231;&#227;o de um possivel mapa temos em conta cinco parametros sendo que, se algum deles tiver valor negativo, esse mapa ser&#225; vetado.
(a valida&#231;&#227;o n&#227;o necessita a organiza&#231;&#227;o dos termos).</p><p>A fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:validaPotencialMapa" title="Tarefa1_2021li1g040">validaPotencialMapa</a></code> &#233; definida da seguinte forma:</p><pre>validaPotencialMapa :: [(Peca, Coordenadas)] -&gt; Bool
validaPotencialMapa [] = False
validaPotencialMapa l = validaPosicao l &amp;&amp; validaChao l &amp;&amp; validaPorta l &amp;&amp; validaPorta' r &amp;&amp; validaCaixa l &amp;&amp; validaEspacosVazios r
    where r = pura l (cMaisBaixos (percursoChao l))

</pre><p>E, com ela, validamos ent&#227;o:</p><ul><li>A posi&#231;&#227;o de cada pe&#231;a (n&#227;o haver sobreposi&#231;&#227;o de pe&#231;as) com a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:validaPosicao" title="Tarefa1_2021li1g040">validaPosicao</a></code>; </li><li>A existencia de uma &#250;nica porta (e esta ser a cima do ch&#227;o)com as fun&#231;&#245;es <code><a href="Tarefa1_2021li1g040.html#v:validaPorta" title="Tarefa1_2021li1g040">validaPorta</a></code> e <code><a href="Tarefa1_2021li1g040.html#v:validaPorta-39-" title="Tarefa1_2021li1g040">validaPorta'</a></code>;</li><li>A aus&#234;ncia de caixas a flutuar com a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:validaCaixa" title="Tarefa1_2021li1g040">validaCaixa</a></code>; </li><li>Se h&#225; algum espa&#231;o vazio no mapa com a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:validaEspacosVazios" title="Tarefa1_2021li1g040">validaEspacosVazios</a></code>;</li><li>Se o mapa tem um ch&#227;o completo com a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:validaChao" title="Tarefa1_2021li1g040">validaChao</a></code>.</li></ul></div></div><div class="top"><p class="src"><a id="v:percursoChao" class="def">percursoChao</a> <a href="#v:percursoChao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>devolve as coordenadas por onde passa o ch&#227;o</p></td></tr></table></div><div class="doc"><p>Coordenadas por onde passa o ch&#227;o </p></div></div><div class="top"><p class="src"><a id="v:listadoChao" class="def">listadoChao</a> <a href="#v:listadoChao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>Recebe uma dire&#231;&#227;o</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Recebe as coordenadas do ch&#227;o atual</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Recebe uma lista vazia que serve de acomulador</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Recebe a lista de coordenadas dos blocos do mapa</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Recebe as coordenadas do ultimo bloco</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Devolve a lista de blocos por onde passa o ch&#227;o</p></td></tr></table></div><div class="doc"><p>Semelhante &#225; fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:verifCont" title="Tarefa1_2021li1g040">verifCont</a></code> pois utiliza as fun&#231;&#245;es <code><a href="Tarefa1_2021li1g040.html#v:habloco" title="Tarefa1_2021li1g040">habloco</a></code>, <code><a href="Tarefa1_2021li1g040.html#v:eomaisbaixo" title="Tarefa1_2021li1g040">eomaisbaixo</a></code>, <code><a href="Tarefa1_2021li1g040.html#v:listaBlocos" title="Tarefa1_2021li1g040">listaBlocos</a></code>, 
sendo a &#250;nica exce&#231;&#227;o a devolu&#231;&#227;o de um mapa ao inv&#234;s de um booliano.</p></div></div><div class="top"><p class="src"><a id="v:validaPosicao" class="def">validaPosicao</a> <a href="#v:validaPosicao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Devolve False se dois termos estiverem na mesma posi&#231;&#227;o </p></td></tr></table></div><div class="doc"><h2>Valida&#231;&#227;o das Posi&#231;&#245;es</h2><p>Para validar a posi&#231;&#227;o comparamos, com uma fun&#231;&#227;o auxiliar, o primeiro termo com todos os outros (com a fun&#231;&#227;o recursiva validaCabeca) e, caso algum seja igual, devolve False. </p><p>Caso o termo n&#227;o se repita, repete-se o procedimento para o termo asseguir.  </p><pre>validaPosicao :: [(Peca, Coordenadas)] -&gt; Bool
validaPosicao [(_,_)] = True 
validaPosicao (termo : resto) = validaCabeca (termo : resto) &amp;&amp; validaPosicao resto

validaCabeca [(p, (coluna1 , linha1))] = True 
validaCabeca ((p, (coluna1 , linha1)) : (_, (coluna2 , linha2)) : resto') = (coluna1 <code>/=</code> coluna2 || linha1 <code>/=</code> linha2) &amp;&amp; validaCabeca((p, (coluna1 , linha1)) : resto')

</pre><p>Com isto verificamos se existem elementos em posi&#231;&#245;es repetidas.</p></div></div><div class="top"><p class="src"><a id="v:validaPorta" class="def">validaPorta</a> <a href="#v:validaPorta" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa </p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Devolve True se existir uma &#250;nica porta  </p></td></tr></table></div><div class="doc"><h2>Valida&#231;&#227;o da Porta</h2><p>Para validar as portas, come&#231;amos por correr a fun&#231;&#227;o at&#233; ocorrer a primeira porta, se tal n&#227;o acontecer devolve False.</p><p>Caso aconte&#231;a &#233; ativado uma segunda fun&#231;&#227;o chamada validaPorta' que continua a correr a fun&#231;&#227;o at&#233; encontrar uma segunda 
porta, se encontrar devolve False e se acabar o mapa devolve True.</p><p>Depois ainda &#233; corrida uma fun&#231;&#227;o para verificar se a porta que existe est&#225; acess&#237;vel</p><pre>validaPorta :: [(Peca, Coordenadas)] -&gt; Bool
validaPorta [] = False
validaPorta ((p,_) : resto) | p /= Porta = validaPorta resto
                            | otherwise = validaPorta'' resto
    where
    validaPorta'' :: [(Peca, Coordenadas)] -&gt; Bool
    validaPorta'' [] = True
    validaPorta'' ((p,_) : resto) =  p /= Porta &amp;&amp; validaPorta'' resto
</pre></div></div><div class="top"><p class="src"><a id="v:validaPorta-39-" class="def">validaPorta'</a> <a href="#v:validaPorta-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa com o ch&#227;o coberto at&#233; &#224; &#250;ltima linha</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>devolve True se ainda existir porta</p></td></tr></table></div><div class="doc"><pre>validaPorta' :: [(Peca, Coordenadas)] -&gt; Bool
validaPorta' [] = False
validaPorta'  ((p,_) : resto) | p /= Porta = validaPorta' resto
                              | otherwise = validaPorta'' resto
    where
    validaPorta'' :: [(Peca, Coordenadas)] -&gt; Bool
    validaPorta'' [] = True
    validaPorta'' ((p,_) : resto) =  p /= Porta &amp;&amp; validaPorta'' resto
</pre><p>Com isto validamos a porta.</p></div></div><div class="top"><p class="src"><a id="v:validaCaixa" class="def">validaCaixa</a> <a href="#v:validaCaixa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe um mapa </p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Devolve True se n&#227;o existirem caixas ou se, as que existirem tiverem um Bloco/Caixa por baixo</p></td></tr></table></div><div class="doc"><h2>Valida&#231;&#227;o das caixas</h2><p>N&#227;o &#233; neciss&#225;ria a exist&#234;ncia de Caixas num mapa, por&#233;m, &#233; necess&#225;rio um ch&#227;o por baixo delas.</p><p>Tendo isso em conta, procede-se ent&#227;o com a fun&#231;&#227;o validaCaixa' que precorre o mapa em busca de uma caixa, se esta n&#227;o existir
n&#227;o h&#225; problemas (devolve True).</p><p>Caso exista, com a fun&#231;&#227;o validaSubCaixa, vai-se procurar no mapa dado, a base da caixa, se esta existir e n&#227;o for uma porta devolver&#225; True. </p><pre>validaCaixa :: [(Peca, Coordenadas)] -&gt; Bool
validaCaixa l = validaCaixa' l l
    where
    validaCaixa' :: [(Peca, Coordenadas)] -&gt; [(Peca, Coordenadas)] -&gt; Bool
    validaCaixa' [] _= True
    validaCaixa' ((peca,(coluna,linha)) : ss) mapa | peca == Caixa = validaSubCaixa (coluna,linha + 1) mapa &amp;&amp; validaCaixa' ss mapa
                                                   | otherwise = validaCaixa' ss mapa
        where
        validaSubCaixa :: Coordenadas -&gt; [(Peca, Coordenadas)] -&gt; Bool
        validaSubCaixa (_,_) [] = False
        validaSubCaixa (col1, line1) ((peca,(col2, line2)): ss) 
                        | col1 == col2 &amp;&amp; line1 == line2 &amp;&amp; (peca == Caixa || peca == Bloco) = True
                        | otherwise = validaSubCaixa (col1, line1) ss

</pre><p>Com isto validamos as possiveis caixas.</p></div></div><div class="top"><p class="src"><a id="v:validaEspacosVazios" class="def">validaEspacosVazios</a> <a href="#v:validaEspacosVazios" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa com a baixo do ch&#227;o coberto de blocos</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Devolve True se o mapa tiver pelo menos um espa&#231;o vazio e False se tal n&#227;o acontecer</p></td></tr></table></div><div class="doc"><h2>Verifica&#231;&#227;o da exist&#234;ncia de espa&#231;os vazios</h2><p>Para o mapa ser us&#225;vel &#233; necess&#225;rio que haja pelo menos um sitio onde colocar a personagem.</p><p>Para isso utilizamos a fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:validaEspacosVazios" title="Tarefa1_2021li1g040">validaEspacosVazios</a></code> que compara o espa&#231;o ocupado por pe&#231;as com o tamanho escalar do mapa
caso tal espa&#231;o seja igual ou superior devolve False.</p><pre>
validaEspacosVazios l = validaEspacosVazios' l (tamanhoMapa l)
    where
    validaEspacosVazios' :: [(Peca, Coordenadas)] -&gt; (Int,Int) -&gt; Bool
    validaEspacosVazios' p (c,l) = elemVazios p || espacoOcupado &lt; espacosTotais
        where espacoOcupado = length p
              espacosTotais = (c+1)*(l+1)
              elemVazios [] = False
              elemVazios ((pecas, (_, _)) : xs) | pecas == Vazio = True
                                                | otherwise = elemVazios xs

</pre><p>Com isto verificamos se o mapa &#233; jog&#225;vel.</p></div></div><div class="top"><p class="src"><a id="v:validaChao" class="def">validaChao</a> <a href="#v:validaChao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa </p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Verifica se existe caixas e se existir verifica se n&#227;o flotuam</p></td></tr></table></div><div class="doc"><h2>Verifica&#231;&#227;o da exist&#234;ncia de um ch&#227;o</h2><p>Para a personagem poder percorrer todo o mapa &#233; necess&#225;rio que exista um ch&#227;o para ela andar.
Verificamos tal exist&#234;ncia com o auxilio da da fun&#231;&#227;o <code><a href="Tarefa1_2021li1g040.html#v:validaChao" title="Tarefa1_2021li1g040">validaChao</a></code> que percorre a fun&#231;&#227;o e verifica se existe umch&#227;o continuo que passa por todas as colunas,
se tal existir devolve true.</p><p>Estes testes s&#227;o exemplos:</p><pre>testes :: Int -&gt; Bool
testes x |x== 1 = validaChao [(Bloco,(0,3)),(Porta,(0,2)),(Bloco, (1,3)),(Bloco, (1,4)),(Bloco,(1,5)),(Bloco,(2,5)),(Bloco,(3,5)),(Bloco,(3,4)),(Bloco,(3,3)),(Bloco,(4,3)),(Bloco,(5,3))] --True
         |x== 2 = validaChao [(Bloco,(0,3)),(Porta,(0,2)),(Bloco, (0,4)),(Bloco, (1,3)),(Bloco,(1,4)),(Bloco,(1,5)),(Bloco,(2,5)),(Bloco,(3,5)),(Bloco,(3,4)),(Bloco,(3,3)),(Bloco,(4,3)),(Bloco,(5,3))] --True
         |x== 3 = validaChao [(Bloco,(0,3)),(Porta,(0,2)),(Bloco, (1,3)),(Bloco, (1,4)),(Bloco,(1,5)),(Bloco,(2,5)),(Bloco,(3,5)),(Bloco,(3,4)),(Bloco,(3,3)),(Bloco,(4,3)),(Bloco,(5,3)),(Bloco, (0,0)),(Bloco, (3,0))]--True
         |x== 4 = validaChao [(Bloco,(0,3)),(Porta,(0,2)),(Bloco, (1,3)),(Bloco, (1,4)),(Bloco,(1,5)),(Bloco,(2,5)),(Bloco,(3,5)),(Bloco,(3,4)),(Bloco,(3,3)),(Bloco,(4,3)),(Bloco,(5,3)),(Bloco, (0,0)),(Bloco, (3,0)),(Bloco,(2,6))] --False
         |x== 5 = validaChao [(Bloco,(0,0)),(Bloco,(2,0))] --False
         |x== 6 = validaChao [(Bloco,(1,1))]--False 
         |x== 7 = validaChao [(Bloco,(0,4))]--True
         |x== 8 = validaChao [(Bloco,(0,4)),(Bloco,(0,3)),(Bloco,(0,2)),(Bloco,(1,2))] --True
         |x== 9 = validaChao [(Bloco,(0,0)),(Bloco,(1,0)),(Bloco,(1,1)),(Bloco,(1,2)),(Bloco,(1,3)),(Bloco, (2,1))]--False
         |x== 0 = validaChao [(Bloco,(0,0)),(Bloco,(1,0)),(Bloco,(1,1)),(Bloco,(1,3)),(Bloco,(2,3))]--False
         |x==10 = validaChao [(Bloco,(0,3)),(Bloco, (1,3)),(Bloco, (2,3)),(Bloco, (1,4)),(Bloco,(1,5)),(Bloco,(2,5)),(Bloco,(3,5)),(Bloco,(4,4)),(Bloco,(4,3)),(Bloco,(4,5)),(Bloco,(5,3)),(Bloco, (0,0)),(Bloco, (3,0))] --True
         |x==11 = validaChao [(Bloco,(0,0)),(Bloco,(1,1)),(Bloco,(2,2)),(Bloco,(3,1)),(Bloco,(4,0))] --True

</pre><p>Com isto confirmamos por fim se existe algum boraco no mapa.</p><p>Para facilitar o processo come&#231;amos,com <code><a href="Tarefa1_2021li1g040.html#v:listaBlocos" title="Tarefa1_2021li1g040">listaBlocos</a></code>, por isolar as coordenadas dos Blocos.</p></div></div><div class="top"><p class="src"><a id="v:listaBlocos" class="def">listaBlocos</a> <a href="#v:listaBlocos" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa completo </p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Devolve uma lista com apenas as coordenadas de todos os blocos </p></td></tr></table></div><div class="doc"><p>coordenadas de todos os blocos</p></div></div><div class="top"><p class="src"><a id="v:verifCont" class="def">verifCont</a> <a href="#v:verifCont" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>De onde veio</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Onde est&#225; de momento</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>coordenadas dos blocos do mapa</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Tamanho do mapa</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o verifCont recebe um inteiro que pode ser um de tr&#234;s e representa a dire&#231;&#227;o por onde veio:</p><ul><li>0 -&gt; vem da esquerda</li><li>1 -&gt; vem de cima</li><li>2 -&gt; vem de baixo</li></ul><p>Precisamos de saber em que coordenadas come&#231;ar o ch&#227;o e onde acabar, para isso usamos as fun&#231;&#245;es que se seguem.</p></div></div><div class="top"><p class="src"><a id="v:findFrstChao" class="def">findFrstChao</a> <a href="#v:findFrstChao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Recebe a lista com as coordenadas dos blocos</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Recebe as coordenadas do primeiro bloco do ma</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Devolve as coordenadas do bloco mais perdo do canto inferior esquerdo</p></td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o que verifica se a coordenada recebida &#233; a mais baixa da coluna.</p></div></div><div class="top"><p class="src"><a id="v:findLastChao" class="def">findLastChao</a> <a href="#v:findLastChao" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Recebe a lista com as coordenadas dos blocos</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Recebe as coordenadas do primeiro bloco do mapa</p></td></tr><tr><td class="src">-&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Devolve as coordenadas do bloco mais perdo do canto inferior direito</p></td></tr></table></div><div class="doc"><p>procura o ultimo ch&#227;o</p></div></div><div class="top"><p class="src"><a id="v:eomaisbaixo" class="def">eomaisbaixo</a> <a href="#v:eomaisbaixo" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Recebe as coordenadas a verificar</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Recebe a lista com as coordenadas dos blocos</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Verifica se a coordenada recebida &#233; a mais baixa da coluna</p></td></tr></table></div><div class="doc"><p>verifica se &#233; o mais baixo da coluna</p></div></div><div class="top"><p class="src"><a id="v:habloco" class="def">habloco</a> <a href="#v:habloco" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a></td><td class="doc"><p>Recebe as coordenadas a verificar</p></td></tr><tr><td class="src">-&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</td><td class="doc"><p>Recebe a lista com as coordenadas dos blocos</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>Verifica se existe um bloco na coordenada que recebe</p></td></tr></table></div><div class="doc"><p>Fun&#231;&#227;o que verifica se existe um bloco na coordenada que recebe.</p></div></div><div class="top"><p class="src"><a id="v:tamanhoMapa" class="def">tamanhoMapa</a> <a href="#v:tamanhoMapa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Recebe o mapa</p></td></tr><tr><td class="src">-&gt; (Int, Int)</td><td class="doc"><p>Devolve o par (ultimaColuna, ultimaLinha)</p></td></tr></table></div><div class="doc"><p>Para o quarto e quinto passo foi usado uma fun&#231;&#227;o que devolvia a escala do mapa. A essa fun&#231;&#227;o chamamos <code><a href="Tarefa1_2021li1g040.html#v:tamanhoMapa" title="Tarefa1_2021li1g040">tamanhoMapa</a></code>.</p><pre>tamanhoMapa :: [(Peca, Coordenadas)] -&gt; (Int,Int)
tamanhoMapa  = maximo (0,0)
    where
    maximo :: (Ord a, Ord b) =&gt; (a, b) -&gt; [(a3, (a, b))] -&gt; (a, b)
    maximo acc [] = acc
    maximo (mc , ml) ((p1, (c1 , l1)) : resto) | mc &gt;= c1 &amp;&amp; ml &gt;= l1 = maximo (mc,ml) resto
                                               | mc &gt;= c1 &amp;&amp; ml &lt; l1 = maximo (mc,l1) resto
                                               | mc <code>&lt;</code> c1 &amp;&amp; ml <code>&gt;=</code> l1 = maximo (c1,ml) resto
                                               | mc &lt; c1 &amp;&amp; ml &lt; l1 = maximo (c1,l1) resto

</pre><p>Atrav&#233;s desta fun&#231;&#227;o &#233; nos fornecido tanto o n&#250;mero m&#225;ximo de linhas/colunas como o n&#250;mero de parcelas do mapa.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>